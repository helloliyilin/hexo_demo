---
title: RSA证书验签
date: 2024-04-29 11:06:27
tags: 密评
---

### 1. 提取颁发者公钥

查看证书链，可以确定颁发者和被颁发者的证书，查看证书信息，在帧数路径可以查看上下级关系。

![image-20240429111156865](./img/证书信息.png)

这里的颁发者是BeiJing ROOT CA，打开BeiJing ROOT CA的证书，我们需要提取该颁发者的公钥。

![image-20240429111755719](./img/根证书信息.png)

提取出来的公钥格式是hex编码，把hex编码转为pem编码。

![image-20240429112008340](./img/公钥hex转pem.png)

### 2. 提取用户证书的待签名数据

用户证书的待签名数据为基本证书域的内容，该内容为ANS.1形式的编码，使用**Asn1Editor**工具提取该内容。

![image-20240429112942363](./img/基本证书域提取.png)

### 3. 提取用户证书的签名值域

提取的签名值域不是要ans.1格式，而是需要TLV中的V值。

![image-20240429113328803](./img/签名值域提取.png)

### 4.验签

![image-20240429113813482](./img/验签成功.png)

总结：公钥使用ASN.1编码的上级CA证书的公钥值，待签名数据使用ASN.1编码的用户证书的基本证书域，签名值使用ASN.1解码后TLV中的V值的用户证书的签名值域。